import{d as W,y as ee,g as te,i as p,j as F,z as C,A as x,B as se,C as z,q as f,r as ne,o as i,b as c,e as u,h as y,f as a,t as h,u as v,H as ae,D,w as H,F as E,E as S,l as $,S as G,M as j,I as J,G as oe,_ as le}from"./index-DtFCpcks.js";import{T as V}from"./TechList-Cz8oZc8W.js";import{C as re,m as ie}from"./CompendiumPage-BjhLhkbu.js";import{s as A}from"./capital_ships-BOrq68-Q.js";import{s as ce}from"./spacebuildings-CVaBZ2bu.js";import{m as M}from"./ModulePage.vue_vue_type_script_setup_true_lang-HQAqrKuF.js";import{o as ue}from"./Data-Djf6rtcE.js";import"./byTypes-DiOuyN-I.js";import"./Page-CtOkfGQ1.js";import"./globals-D0lvPSen.js";import"./sec2str-CqR_vxEK.js";const de={class:"container"},me={class:"select"},pe=["value","selected"],fe=["onClick"],ve={class:"meta"},_e={class:"avatar"},Ce=["src","alt"],he={class:"sort-tech"},ge=["k"],Ie={class:"modal-filter-tech"},Te={class:"sections-group other"},ye={class:"type",name:"user-info"},Ee=["onClick"],Se=5,Y=50,Me=W({__name:"CompendiumCorp",setup(Le){var P;const g=ee(),{t:q}=te(),X=q("HS_COMPENDIUM"),k=(P=new Intl.Locale(navigator.language))==null?void 0:P.hourCycles,Z=k?["h23","h24"].some(t=>k.includes(t)):!0,r={LocalTime:{icon:{name:"time",dir:"icons/compendium"},formatter:({localTime:t,localTime24:s})=>Z?s:t},AfkFor:{icon:{name:"afk",dir:"icons/compendium"},formatter:({afkFor:t})=>t},CargoCap:{icon:{name:"cargo",dir:"icons/compendium"},formatter:({tech:t})=>{let s=0;const[o]=t[f("Transport")]||[],[e]=t[f("TransportCapacity")]||[],[n]=t[f("RelicDrone")]||[];return o&&e&&(s+=A.Transport.JobCapacity[o-1]+M.TransportCapacity.ExtraTradeSlots[e-1]),n&&(s+=M.RelicDrone.drone.JobCapacity[n-1]),s}}},_=p(!1),L=p(!1),b=p(!1),I=p(g.state.userSettings.compendiumCorpLastRoleId),l=F([]),N=p({}),d=p([]),T=F({title:"",lvlMap:void 0});let m=[];d.value=Array.from({length:10},t=>({userId:t,name:"",avatarUrl:""})),C.value.on("connected",()=>O()),C.value.on("disconnected",()=>{m=[],d.value=Array.from({length:10},t=>({userId:t,name:"",avatarUrl:""})),I.value="",l.splice(0),g.commit(x.SET_COMPENDIUM_CORP_LAST_ROLE_ID)}),se(()=>{C.value.getUser()&&O()}),z(I,async t=>{_.value=!0,g.commit(x.SET_COMPENDIUM_CORP_LAST_ROLE_ID,t),m=await C.value.corpdata(t).then(s=>s.members),d.value=m,_.value=!1,B(l)}),z(()=>l,B,{deep:!0});async function O(){_.value=!0;const t=await C.value.corpdata(g.state.userSettings.compendiumCorpLastRoleId);N.value=t,m=t.members,d.value=t.members.slice(0,Y),_.value=!1}async function U(t){R(t.Name)?l.splice(l.indexOf(t.Name),1):l.push(t.Name)}function R(t){return l.includes(t)}function K(t){m.length&&(T.title=t.name,T.lvlMap=ue(t.tech,{map:([s,o])=>[oe(s),o[0]]}),b.value=!0)}function B(t){d.value=m.sort((s,o)=>{var e,n;return t.length&&!(t[0]in r)?(((e=o.tech[f(t[0])])==null?void 0:e[0])||0)-(((n=s.tech[f(t[0])])==null?void 0:n[0])||0):t[0]=="CargoCap"?r.CargoCap.formatter(o)-r.CargoCap.formatter(s):0}).slice(0,Y)}function Q(t){if(!l.length)return{};const s={},o=Object.fromEntries(l.map(e=>{var n;return e in r?[e,r[e].formatter(t)]:[e,(n=t.tech[f(e)])==null?void 0:n[0]]}).slice(Se*-1));for(const e in o){const n=s[e]={icon:{dir:"",name:""},level:o[e]};e in M?(n.icon.dir="game/Modules",n.icon.name=M[e].Icon):e in A?(n.icon.dir="game/Ships",n.icon.name=A[e].Model[5]):e in r?n.icon=r[e].icon:(n.icon.dir="game/SpaceBuildings",n.icon.name=ce[e].PrefabModel)}return s}return(t,s)=>{const o=ne("t");return i(),c("div",null,[u(v(ae),null,{default:y(()=>[a("title",null,h(v(X)),1)]),_:1}),u(re,null,{default:y(()=>[a("div",de,[a("div",{class:D(["filter",{disable:d.value.length>v(m).length}])},[a("div",null,[H(a("button",{class:"btn-tech-filter",onClick:s[0]||(s[0]=e=>L.value=!0)},null,512),[[o,"FILTER"]])]),a("div",me,[a("select",{onChange:s[1]||(s[1]=e=>I.value=e.target.value)},[(i(!0),c(E,null,S(N.value.roles,e=>(i(),c("option",{key:e.id,value:e.id,selected:I.value==e.id},h(e.name),9,pe))),128))],32)])],2),a("ul",{class:D(["members-list",{"animated-fetch":_.value}])},[(i(!0),c(E,null,S(d.value,e=>(i(),c("li",{key:e.userId,class:"member",onClick:n=>K(e)},[a("div",ve,[a("div",_e,[a("img",{src:e.avatarUrl,alt:`${e.name} avatar`,onError:s[2]||(s[2]=n=>n.target.src=v(ie))},null,40,Ce)]),a("p",null,h(e.name),1)]),a("div",he,[a("ul",null,[(i(!0),c(E,null,S(Q(e),(n,w)=>(i(),c("li",{key:w},[a("div",null,[u(J,{name:n.icon.name,dir:n.icon.dir},null,8,["name","dir"]),a("span",{k:w,class:"level"},h(n.level),9,ge)])]))),128))])])],8,fe))),128))],2)])]),_:1}),$("suppress TypeScriptUnresolvedReference "),u(j,{open:L.value,"onUpdate:open":s[4]||(s[4]=e=>L.value=e),title:t.$t("FILTER"),size:v(G).LARGE},{body:y(()=>[a("div",Ie,[a("button",{class:"button accent",onClick:s[3]||(s[3]=e=>l.splice(0))},h(t.$t("RESET_ALL")),1),a("div",Te,[a("section",ye,[H(a("h3",null,null,512),[[o,"TID_OBJECT_ACTION_PLAYER_INFO"]]),a("ul",null,[(i(),c(E,null,S(r,({icon:e},n)=>a("li",{key:n,class:"item"},[a("div",{class:D({mute:R(n)}),onClick:()=>U({Name:n})},[u(J,{name:e.name,dir:e.dir},null,8,["name","dir"])],10,Ee)])),64))])])]),u(V,{"on-click":U,"is-muted":R})])]),_:1},8,["open","title","size"]),$("suppress TypeScriptUnresolvedReference "),u(j,{open:b.value,"onUpdate:open":s[5]||(s[5]=e=>b.value=e),title:T.title,size:v(G).LARGE},{body:y(()=>[u(V,{"level-map":T.lvlMap},null,8,["level-map"])]),_:1},8,["open","title","size"])])}}}),Fe=le(Me,[["__scopeId","data-v-dcc77907"],["__file","/home/runner/work/HadesSpace/HadesSpace/src/pages/CompendiumCorp.vue"]]);export{Fe as default};
