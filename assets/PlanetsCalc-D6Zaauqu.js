import{d as se,y as oe,g as ne,i as V,j as re,S as ie,a as ce,A as O,r as ue,o as d,b as p,f as n,e as N,w as j,u as y,l as J,h as q,F as g,E as A,t as R,m as de,M as pe,C as me,D as X,v as _e,x as ve,W as fe,_ as Se}from"./index-DtFCpcks.js";import{l as Z,Y as F}from"./planet_levels-unpUm6_N.js";import{o as k,p as he,V as Ce}from"./Data-Djf6rtcE.js";import{s as ge}from"./spacebuildings-CVaBZ2bu.js";import{g as Te}from"./globals-D0lvPSen.js";import{C as Le}from"./Calculator-BHz9Xh3N.js";import{N as ye}from"./NumberPicker-DU54sA0b.js";import{g as Ae}from"./getFilterByType-mSKMdPnQ.js";import"./sec2str-CqR_vxEK.js";import"./MultiConfigGUI-BpLrj83M.js";import"./byTypes-DiOuyN-I.js";function Pe(T){return T[0].map((B,I)=>T.map(E=>E[I]))}const b=T=>(_e("data-v-4540a79b"),T=T(),ve(),T),Re={class:"wrap"},be={class:"container"},Ie={class:"switch"},Ee={class:"name"},Me=b(()=>n("p",null,null,-1)),De=["checked"],Ne=b(()=>n("label",{for:"compact-mode",class:"label"},null,-1)),ke=b(()=>n("th",null,null,-1)),Ue=["onChange"],xe=["selected"],He=b(()=>n("td",null,null,-1)),Ve={class:"number-picker"},Oe=["onClick"],je=b(()=>n("img",{src:fe,class:"open-info",alt:"info icon"},null,-1)),qe=[je],Fe={class:"modal-module"},Be={class:"chars"},We={class:"output"},$e=se({__name:"PlanetsCalc",setup(T){const{SP2ShipmentsBoostPct:B}=Te,I={CreditStorage:"CreditStorageModifier",FuelStorage:"FuelStorageModifier",CreditsPerHour:"CreditIncomeModifier",FuelPerHour:"FuelIncomeModifier",ShipmentsCRValuePerDay:"CreditShipmentModifier"},E={TotalShipmentCRPerDay:"ShipmentsCRValuePerDay",Cost:"Cost",ConstructionTime:"TimeToUpgrade"},W=["XPAward","Cost","TimeToUpgrade","TimeToUpgradeParallel","RSLevelReq"],$=["CrystalsWeight","Name"],w=Object.keys(Z).filter(a=>![...W,...$].includes(a)),K=Object.values(F.NumMoons).reduce((a,t,i)=>(t&&(Array.isArray(t)?t.forEach((e,l)=>a[F.PlanetTypes[i][l]]=e):a[F.PlanetTypes[i]]=t),a),{}),U=oe(),{t:Q}=ne(),Y=V([]),S=V({actually:{},plan:{}}),x=V(!1),L=re({size:ie.SMALL,title:"name",data:{planet:{},get key(){return this.planet.Name}}}),h=ce(()=>Object.values(Y.value));let _;U.subscribe(a=>{a.type==O.SWITCH_PLANETS_CALC_SP2&&_&&(z(_),_.forceReCalc()),a.type==O.SET_CALC_DAY_CREDIT_LIMIT&&_.forceReCalc()});function z(a){_=a,Y.value=a.provideGetterElements(le)}function ee(a){L.title=Q(a.TID),L.data.planet=a,x.value=!0}function G(a,t){return _.outputClasses(a,L.data.key,t)}function te(a,t){h.value.forEach(async({Name:i})=>{i.startsWith("TradingStation")||_.onChangeLvl(a,i,parseInt(t))})}function ae(a,t){let i=0;const e={};for(const l of w)t.total.intermediate[l]={actually:0,plan:0,sum:0};return me(()=>t.total.result.TimeToUpgrade,()=>{i=0}),function(l,s){var r,v;const c=U.state.userSettings.calcDayCreditLimit/24;let o=0;for(const u of w)t.total.intermediate[u].actually+=((r=t.actually[l])==null?void 0:r[u])||0,t.total.intermediate[u].plan+=((v=t.plan[l])==null?void 0:v[u])||0,t.total.intermediate[u].sum=t.total.intermediate[u].actually+t.total.intermediate[u].plan;if(a[l].RSLevelReq){const u=a[l].RSLevelReq[s.plan[l]-1]||0;i=t.total.result.RSLevelReq=i<u?u:i}if(a[l].TimeToUpgrade){const u=a[l],P=s.actually[l],M=s.plan[l],m=[];for(let f=0;f<M-P;f++){const C=P+f,H=u.TimeToUpgrade[C]/3600;for(let D=0;D<H;D++)m.push(u.Cost[C]/(u.TimeToUpgrade[C]/3600))}m.length?e[l]=m:delete e[l],Object.keys(e).length&&(Pe(Object.values(e)).forEach(f=>{const C=f.reduce((H,D)=>H+D||0,0);o+=Math.ceil(C/c)}),t.total.result.TimeToUpgradeParallel=o*3600)}}}function le(...[a,t]){const i=U.state.userSettings.planetsCalcSp2?B/100:0,e=k(Z,{filter:([,o])=>Array.isArray(o)}),l=k(he,{...Ae("planets.yellowstar"),map:([o,r])=>(t[o]=k(e,{map:([v,u])=>{const P=r.MaxUpgradeLevel,M=(r.Name in K?K[r.Name]:0)+1;let m=u.map(f=>f*(v in I?r[I[v]]/100:1));return v=="ShipmentsCRValuePerDay"&&(m=m.map(f=>{const C=f*M;return C+C*i})),v=="MaxShipments"&&(m=m.map(f=>f*M)),m.length<P&&m.push(...Array.from({length:P-m.length},()=>m[m.length-1])),[v,m]}}),[o,r])});let s=0;const c=k(ge.TradingStation,{map:([o,r])=>(Array.isArray(r)&&r.length>s&&(s=r.length),o=="TotalShipmentCRPerDay"&&(r=r.map(v=>v+v*i)),[o in E?E[o]:o,r])});c.MaxUpgradeLevel=s;for(let o=0;c.MaxOnOwnSolarSystem>o;o++){const r={...c,Name:`${c.Name}_${o}`};l[r.Name]=r,t[r.Name]=a(r,s)}return l}return(a,t)=>{const i=ue("t");return d(),p("div",Re,[n("div",be,[N(Le,{input:S.value,"onUpdate:input":t[0]||(t[0]=e=>S.value=e),"stack-chars":W,"calc-total":ae,"local-storage-key":"planetsCalc","title-key":"PLANETS_CALC",onSetup:z},null,8,["input"]),n("div",Ie,[n("div",null,[j(n("p",Ee,null,512),[[i,"TID_STARTER_PACK_2"]]),Me]),n("input",{id:"compact-mode",class:"checkbox",type:"checkbox",checked:a.$store.state.userSettings.planetsCalcSp2,onChange:t[1]||(t[1]=e=>a.$store.commit(y(O).SWITCH_PLANETS_CALC_SP2))},null,40,De),Ne]),J("suppress JSUnresolvedReference "),J("  WS moment: Unresolved variable or type planetValues"),N(Ce,{data:{TID:"",Name:"Input",TID2:["",...h.value.map(e=>e.TID)]},"table-opts":{lvlColKey:"â„–",mergeCells:!1,colLvlStartAt:0}},{"table-head":q(()=>[j(n("th",null,null,512),[[i,"CURRENT_LVL"]]),j(n("th",null,null,512),[[i,"PLAN_LVL"]]),ke]),"table-body":q(({row:e})=>[e==0?(d(),p(g,{key:0},[(d(!0),p(g,null,A(S.value,(l,s)=>(d(),p("td",{key:s},[n("select",{class:"select",onChange:c=>te(s,c.target.value)},[(d(!0),p(g,null,A(h.value[e].MaxUpgradeLevel+1,(c,o)=>(d(),p("option",{key:s+c,selected:y(_).isSelected(s,h.value[e].Name,o)},R(o),9,xe))),128))],40,Ue)]))),128)),He],64)):(d(),p(g,{key:1},[(d(!0),p(g,null,A(S.value,(l,s)=>{var c,o;return d(),p("td",{key:s},[n("div",Ve,[N(ye,{value:((c=S.value[s])==null?void 0:c[h.value[e-1].Name])||0,min:(s=="plan"?(o=S.value.actually)==null?void 0:o[h.value[e-1].Name]:0)||0,max:h.value[e-1].MaxUpgradeLevel,"onUpdate:value":r=>y(_).onChangeLvl(s,h.value[e-1].Name,r)},null,8,["value","min","max","onUpdate:value"])])])}),128)),n("td",null,[n("div",{onClick:()=>ee(h.value[e-1])},[...qe],8,Oe)])],64))]),_:1},8,["data"])]),N(pe,de({open:x.value,"onUpdate:open":t[2]||(t[2]=e=>x.value=e)},L),{body:q(()=>[n("div",Fe,[n("ul",Be,[n("li",We,[n("b",null,R(a.$t("TID_PLANET_LEVEL_DESCR")),1),n("div",null,[(d(!0),p(g,null,A(S.value,(e,l)=>{var s;return d(),p("span",{key:l,class:X(G(l,null))},R((s=S.value[l])==null?void 0:s[L.data.key]),3)}),128))])]),(d(!0),p(g,null,A(Object.keys(y(_).output.plan[L.data.key]||{}).filter(e=>!$.includes(e)),e=>(d(),p("li",{key:e,class:"calc.output"},[n("b",null,R(y(_).format.key(e)),1),n("div",null,[(d(!0),p(g,null,A(S.value,(l,s)=>{var c,o;return d(),p("span",{key:s,class:X(G(s,e))},R(y(_).format.value(e,Math.trunc((o=(c=y(_).output[s])==null?void 0:c[L.data.key])==null?void 0:o[e])||void 0)),3)}),128))])]))),128))])])]),_:1},16,["open"])])}}}),at=Se($e,[["__scopeId","data-v-4540a79b"],["__file","/home/runner/work/HadesSpace/HadesSpace/src/pages/PlanetsCalc.vue"]]);export{at as default};
